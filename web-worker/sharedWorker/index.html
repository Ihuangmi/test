<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <title>index page</title>
  </head>

  <style>
    .page {
      text-align: center;
    }
  </style>

  <body>
    <div class="page">
      <h1>index page:</h1>
      count: <span id="container">0</span>
      <button id="add">add</button>
      <br />
      <h1>åˆ©ç”¨iframeåŠ è½½</h1>
      <br />
      <iframe src="./iframe.html"></iframe>
    </div>
  </body>

  <script type="text/javascript">
    if (!!window.SharedWorker) {
      const container = document.getElementById("container");
      const add = document.getElementById("add");

      //   åˆ›å»º SharedWorker
      const myWorker = new SharedWorker("./sharedWorker.js");

      //   å¯åŠ¨ç«¯å£
      myWorker.port.start();

      //   ç›‘å¬ SharedWorker è¿”å›æ¶ˆæ¯
      myWorker.port.onmessage = (msg) => {
        console.log("ğŸš€  num:", msg.data);
        container.innerText = msg.data;
      };

      add.onclick = () => {
        // å‘ SharedWorker å‘é€æ¶ˆæ¯
        myWorker.port.postMessage("add");
      };
    }
  </script>
</html>
